# BUG-007: external_website captures nuffieldhealthcareers.com

**Severity:** Minor
**Status:** Fixed
**Found in:** QA Pre-testing — live scrape of `professor-stephen-mcdonnell`
**Spec reference:** Quick Spec §3.2 `external_website` field; R4 §14.3 finding #6
**Date:** 2026-02-28

## Description

Filter uses `href.includes("nuffieldhealth.com")` which matches subdomains like `nuffieldhealthcareers.com` via substring. A careers site URL is incorrectly captured as the consultant's external website.

## Root Cause

Simple string `.includes()` check doesn't distinguish between `nuffieldhealth.com` and `nuffieldhealthcareers.com` — both contain the substring "nuffieldhealth.com" but the latter is a different domain entirely.

## Fix

- Replaced substring check with URL hostname parsing — reject if hostname equals `nuffieldhealth.com` or ends with `.nuffieldhealth.com`
- Explicitly reject `nuffieldhealthcareers.com` and its subdomains
- Added `isSafelinkWrapper()` to reject Outlook SafeLinks URLs (`safelinks.protection.outlook.com`) that wrap internal links

## Regression Tests

- `parse.test.ts`: "rejects nuffieldhealthcareers.com as internal"
- `parse.test.ts`: "accepts genuine external URLs"
- `parse.test.ts`: "rejects Outlook SafeLinks wrapping nuffieldhealth.com"

## Files Changed

- `src/scraper/parse.ts` — `extractExternalWebsite`
