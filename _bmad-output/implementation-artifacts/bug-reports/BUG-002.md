# BUG-002: Specialty array includes label prefix and trailing commas

**Severity:** Moderate
**Status:** Fixed
**Found in:** QA Pre-testing — live scrape of `professor-stephen-mcdonnell`
**Spec reference:** Quick Spec §3.2 `specialty_primary`, `specialty_sub` fields
**Date:** 2026-02-28

## Description

Paragraph fallback in `extractListItems` includes the label prefix (e.g. "Sub-specialties: Orthopaedics"). `extractSpecialtySub` only checks H3 headings, misses `<p>Sub-specialties: ...</p>` pattern. Trailing commas also persist in extracted items.

## Root Cause

1. `extractListItems` paragraph fallback doesn't strip known label prefixes
2. `extractSpecialtySub` only looks for H3 elements, missing comma-separated paragraph patterns
3. No trailing-comma cleanup on extracted list items

## Fix

- Strip known prefixes ("Sub-specialties:", "Specialties:") from paragraph text in `extractListItems`
- Add paragraph-based comma-split extraction to `extractSpecialtySub`
- Trim and filter empty strings
- Strip trailing commas from all extracted list items

## Regression Tests

- `parse.test.ts`: "strips Sub-specialties: label prefix from paragraph fallback"
- `parse.test.ts`: "extracts sub-specialties from comma-separated paragraph"
- `parse.test.ts`: "strips trailing commas from list items"

## Files Changed

- `src/scraper/parse.ts` — `extractListItems`, `extractSpecialtySub`
